/*! ESAPI-JS - v0.1.3
 *  Release on: 2020-08-06
 *  https://www.owasp.org/index.php/Category:OWASP_Enterprise_Security_API
 *  Copyright (c) 2020 OWASP
 *  Licensed BSD */
var $namespace=function(a,b,c){var d,e,f=a.split(b||"."),g=c||window;for(d=0,e=f.length;e>d;d++)g=g[f[d]]=g[f[d]]||{};return g},$type=function(a,b){if(!a instanceof b)throw new SyntaxError};if(!$)var $=function(a){return document.getElementById(a)};if(String.prototype.charCodeAt||(String.prototype.charCodeAt=function(a){for(var b=this.charAt(a),c=0;65536>c;c++){var d=String.fromCharCode(c);if(d==b)return c}return 0}),String.prototype.endsWith||(String.prototype.endsWith=function(a){return this.substr(this.length-a.length,a.length)==a}),!Exception){var Exception=function(a,b){this.cause=b,this.errorMessage=a};Exception.prototype=Error.prototype,Exception.prototype.getCause=function(){return this.cause},Exception.prototype.getMessage=function(){return this.message},Exception.prototype.getStackTrace=function(){if(this.callstack)return this.callstack;if(this.stack){for(var a=stack.split("\n"),b=0,c=a.length;c>b;b++)a[b].match(/^\s*[A-Za-z0-9\=+\$]+\(/)&&this.callstack.push(a[b]);return this.callstack.shift(),this.callstack}if(window.opera&&this.message){for(var a=this.message.split("\n"),b=0,c=a.length;c>b;b++)if(a[b].match(/^\s*[A-Za-z0-9\=+\$]+\(/)){var d=a[b];a[b+1]&&(d+=" at "+a[b+1],b++),this.callstack.push(d)}return this.callstack.shift(),this.callstack}for(var e=arguments.callee.caller;e;){var f=e.toString(),g=f.substring(f.indexOf("function")+8,f.indexOf("("))||"anonymous";this.callstack.push(g),e=e.caller}return this.callstack},Exception.prototype.printStackTrace=function(a){var b=this.getMessage()+"|||"+this.getStackTrace().join("|||");return this.cause&&this.cause.printStackTrace&&(b+="||||||Caused by "+this.cause.printStackTrace().replace("\n","|||")),a?void(a.value?a.value=b.replace("|||","\n"):a.writeln?a.writeln(b.replace("|||","\n")):a.innerHTML?a.innerHTML=b.replace("|||","<br/>"):a.textContent?a.textContent=b.replace("|||","<br/>"):a.append?a.append(b.replace("|||","\n")):a instanceof Function&&a(b.replace("|||","\n"))):a.replace("|||","\n")}}if(!RuntimeException)var RuntimeException=Exception;if(!IllegalArgumentException)var IllegalArgumentException=Exception;if(!DateFormat){var DateFormat=function(a){var b=a,c={longMonths:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longDays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],d:function(a){return(a.getDate()<10?"0":"")+a.getDate()},D:function(a){return c.shortDays[a.getDay()]},j:function(a){return a.getDate()},l:function(a){return c.longDays[a.getDay()]},N:function(a){return a.getDay()+1},S:function(a){return a.getDate()%10==1&&11!=a.getDate()?"st":a.getDate()%10==2&&12!=a.getDate()?"nd":a.getDate()%10==3&&13!=a.getDate()?"rd":"th"},w:function(a){return a.getDay()},z:function(a){return"Not Yet Supported"},W:function(a){return"Not Yet Supported"},F:function(a){return c.longMonths[a.getMonth()]},m:function(a){return(a.getMonth()<9?"0":"")+(a.getMonth()+1)},M:function(a){return c.shortMonths[a.getMonth()]},n:function(a){return a.getMonth()+1},t:function(a){return"Not Yet Supported"},L:function(a){return a.getFullYear()%4==0&&a.getFullYear()%100!=0||a.getFullYear()%400==0?"1":"0"},o:function(a){return"Not Supported"},Y:function(a){return a.getFullYear()},y:function(a){return(""+a.getFullYear()).substr(2)},a:function(a){return a.getHours()<12?"am":"pm"},A:function(a){return a.getHours()<12?"AM":"PM"},B:function(a){return"Not Yet Supported"},g:function(a){return a.getHours()%12||12},G:function(a){return a.getHours()},h:function(a){return((a.getHours()%12||12)<10?"0":"")+(a.getHours()%12||12)},H:function(a){return(a.getHours()<10?"0":"")+a.getHours()},i:function(a){return(a.getMinutes()<10?"0":"")+a.getMinutes()},s:function(a){return(a.getSeconds()<10?"0":"")+a.getSeconds()},e:function(a){return"Not Yet Supported"},I:function(a){return"Not Supported"},O:function(a){return(-a.getTimezoneOffset()<0?"-":"+")+(Math.abs(a.getTimezoneOffset()/60)<10?"0":"")+Math.abs(a.getTimezoneOffset()/60)+"00"},P:function(a){return(-a.getTimezoneOffset()<0?"-":"+")+(Math.abs(a.getTimezoneOffset()/60)<10?"0":"")+Math.abs(a.getTimezoneOffset()/60)+":"+(Math.abs(a.getTimezoneOffset()%60)<10?"0":"")+Math.abs(a.getTimezoneOffset()%60)},T:function(a){var b=a.getMonth();a.setMonth(0);var c=a.toTimeString().replace(/^.+ \(?([^\)]+)\)?$/,"$1");return a.setMonth(b),c},Z:function(a){return 60*-a.getTimezoneOffset()},c:function(a){return a.format("Y-m-d")+"T"+a.format("H:i:sP")},r:function(a){return a.toString()},U:function(a){return a.getTime()/1e3}};return{format:function(a){for(var d="",e=0;e<b.length;e++){var f=b.charAt(e);d+=c[f]?c[f].call(a):f}return d}}};DateFormat.getDateInstance=function(){return new DateFormat("M/d/y h:i a")}}$namespace("org.owasp.esapi"),org.owasp.esapi.ESAPI=function(a){var b=a;if(!b)throw new RuntimeException("Configuration Error - Unable to load $ESAPI_Properties Object");var c=null,d=null,e=null,f=null,g=null;return{properties:b,encoder:function(){if(!c){if(!b.encoder.Implementation)throw new RuntimeException("Configuration Error - $ESAPI.properties.encoder.Implementation object not found.");c=new b.encoder.Implementation}return c},logFactory:function(){if(!e){if(!b.logging.Implementation)throw new RuntimeException("Configuration Error - $ESAPI.properties.logging.Implementation object not found.");e=new b.logging.Implementation}return e},logger:function(a){return this.logFactory().getLogger(a)},locale:function(){return org.owasp.esapi.i18n.Locale.getLocale(b.localization.DefaultLocale)},resourceBundle:function(){if(!f){if(!b.localization.StandardResourceBundle)throw new RuntimeException("Configuration Error - $ESAPI.properties.localization.StandardResourceBundle not found.");f=new org.owasp.esapi.i18n.ObjectResourceBundle(b.localization.StandardResourceBundle)}return f},validator:function(){if(!d){if(!b.validation.Implementation)throw new RuntimeException("Configuration Error - $ESAPI.properties.validation.Implementation object not found.");d=new b.validation.Implementation}return d},httpUtilities:function(){return g||(g=new org.owasp.esapi.HTTPUtilities),g}}};var $ESAPI=null;with(org.owasp.esapi.ESAPI.initialize=function(){$ESAPI=new org.owasp.esapi.ESAPI(Base.esapi.properties)},$namespace("org.owasp.esapi"),org.owasp.esapi.Encoder=function(){},$namespace("org.owasp.esapi"),org.owasp.esapi.EncoderConstants={CHAR_LOWERS:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],CHAR_UPPERS:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],CHAR_DIGITS:["0","1","2","3","4","5","6","7","8","9"],CHAR_SPECIALS:["!","$","*","+","-",".","=","?","@","^","_","|","~"],CHAR_LETTERS:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],CHAR_ALNUM:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","0","1","2","3","4","5","6","7","8","9"]},$namespace("org.owasp.esapi"),org.owasp.esapi.EnterpriseSecurityException=function(a,b,c){var d=b,e=new Exception(a,c);return{getMessage:e.getMessage,getUserMessage:e.getMessage,getLogMessage:function(){return d},getStackTrace:e.getStackTrace,printStackTrace:e.printStackTrace}},$namespace("org.owasp.esapi"),org.owasp.esapi.HTTPUtilities=function(){var a=$ESAPI.logger("HTTPUtilities"),b=$ESAPI.resourceBundle(),c=org.owasp.esapi.Logger.EventType;return{addCookie:function(d){if($type(d,org.owasp.esapi.net.Cookie),"http:"!=window.top.location.protocol||"https:"!=window.top.location.protocol)throw new RuntimeException(b.getString("HTTPUtilities.Cookie.Protocol",{protocol:window.top.location.protocol}));var e=d.getName(),f=d.getValue(),g=d.getMaxAge(),h=d.getDomain(),i=d.getPath(),j=d.getSecure(),k=new org.owasp.esapi.ValidationErrorList;$ESAPI.validator().getValidInput("cookie name",e,"HttpCookieName",50,!1,k),$ESAPI.validator().getValidInput("cookie value",f,"HttpCookieValue",5e3,!1,k);if(0==k.size()){var l=e+"="+escape(f);l+=g?";expires="+new Date((new Date).getTime()+1e3*g).toGMTString():"",l+=i?";path="+i:"",l+=h?";domain="+h:"",l+=j||$ESAPI.properties.httputilities.cookies.ForceSecure?";secure":"",document.cookie=l}else a.warning(c.SECURITY_FAILURE,b.getString("HTTPUtilities.Cookie.UnsafeData",{name:e,value:f}))},getCookie:function(a){for(var b=document.cookie.split("; "),c=0,d=b.length;d>c;c++){var e=b[c].split("=");if(e[0]==escape(a))return new org.owasp.esapi.net.Cookie(a,e[1]?unescape(e[1]):"")}return null},killAllCookies:function(){for(var a=document.cookie.split("; "),c=0,d=a.length;d>c;c++){var e=a[c].split("="),f=unescape(e[0]);if(!this.killCookie(f))throw new RuntimeException(b.getString("HTTPUtilities.Cookie.CantKill",{name:f}))}},killCookie:function(a){var c=this.getCookie(a);if(c){if(c.setMaxAge(-10),this.addCookie(c),this.getCookie(a))throw new RuntimeException(b.getString("HTTPUtilities.Cookie.CantKill",{name:a}));return!0}return!1},getRequestParameter:function(a){var b=window.top.location.search.substring(1),c=b.indexOf(a);if(0>c)return null;c+=a.length;var d=b.indexOf("&",c);return 0>d&&(d=b.length),unescape(b.substring(c,d))}}},$namespace("org.owasp.esapi"),org.owasp.esapi.IntrusionException=function(a,b,c){var d=new org.owasp.esapi.EnterpriseSecurityException(a,b,c);return{getMessage:d.getMessage,getUserMessage:d.getMessage,getLogMessage:d.getLogMessage,getStackTrace:d.getStackTrace,printStackTrace:d.printStackTrace}},$namespace("org.owasp.esapi"),org.owasp.esapi.LogFactory=function(){return{getLogger:!1}},$namespace("org.owasp.esapi"),org.owasp.esapi.Logger=function(){return{setLevel:!1,fatal:!1,error:!1,isErrorEnabled:!1,warning:!1,isWarningEnabled:!1,info:!1,isInfoEnabled:!1,debug:!1,isDebugEnabled:!1,trace:!1,isTraceEnabled:!1}},org.owasp.esapi.Logger.EventType=function(a,b){var c=a,d=b;return{isSuccess:function(){return d},toString:function(){return c}}},org.owasp.esapi.Logger)EventType.SECURITY_SUCCESS=new EventType("SECURITY SUCCESS",!0),EventType.SECURITY_FAILURE=new EventType("SECURITY FAILURE",!1),EventType.EVENT_SUCCESS=new EventType("EVENT SUCCESS",!0),EventType.EVENT_FAILURE=new EventType("EVENT FAILURE",!1),OFF=Number.MAX_VALUE,FATAL=1e3,ERROR=800,WARNING=600,INFO=400,DEBUG=200,TRACE=100,ALL=Number.MIN_VALUE;$namespace("org.owasp.esapi"),org.owasp.esapi.PreparedString=function(a,b,c){function d(a){for(var b=0,d=0,g=0;g<a.length;g++)a.charAt(g)==c&&(d++,e.push(a.substr(b,g)),b=g+1);e.push(a.substr(b)),f=new Array(d)}var e=[],f=[];return c||(c="?"),d(a),{set:function(a,c,d){if(1>a||a>f.length)throw new IllegalArgumentException("Attempt to set parameter: "+a+" on a PreparedString with only "+f.length+" placeholders");d||(d=b),f[a-1]=d.encode([],c)},toString:function(){for(var a=0;a<f.length;a++)if(null==f[a])throw new RuntimeException("Attempt to render PreparedString without setting parameter "+(a+1));for(var b="",c=0,d=0;d<e.length;d++)b+=e[d],c<f.length&&(b+=f[c++]);return b}}},$namespace("org.owasp.esapi"),org.owasp.esapi.ValidationErrorList=function(){var a=Array();return{addError:function(b,c){if(null==b)throw new RuntimeException("Context cannot be null: "+c.getLogMessage(),c);if(null==c)throw new RuntimeException("Context ("+b+") - Error cannot be null");if(a[b])throw new RuntimeException("Context ("+b+") already exists. must be unique.");a[b]=c},errors:function(){return a},isEmpty:function(){return 0==a.length},size:function(){return a.length}}},$namespace("org.owasp.esapi"),org.owasp.esapi.ValidationRule=function(){return{getValid:!1,setAllowNull:!1,getTypeName:!1,setTypeName:!1,setEncoder:!1,assertValid:!1,getSafe:!1,isValid:!1,whitelist:!1}},$namespace("org.owasp.esapi"),org.owasp.esapi.Validator=function(){return{addRule:!1,getRule:!1,getValidInput:!1,isValidDate:!1,getValidDate:!1,isValidSafeHTML:!1,getValidSafeHTML:!1,isValidCreditCard:!1,getValidCreditCard:!1,isValidFilename:!1,getValidFilename:!1,isValidNumber:!1,getValidNumber:!1,isValidPrintable:!1,getValidPrintable:!1}},$namespace("org.owasp.esapi.codecs.Base64"),org.owasp.esapi.codecs.Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(a){if(!a)return null;for(var b,c,d,e,f,g,h,i="",j=0,k=org.owasp.esapi.codecs.UTF8.encode(a);j<k.length;)b=k.charCodeAt(j++),c=k.charCodeAt(j++),d=k.charCodeAt(j++),e=b>>2,f=(3&b)<<4|c>>4,g=(15&c)<<2|d>>6,h=63&d,isNaN(c)?g=h=64:isNaN(d)&&(h=64),i+=this._keyStr.charAt(e)+this._keyStr.charAt(f)+this._keyStr.charAt(g)+this._keyStr.charAt(h);return i},decode:function(a){if(!a)return null;for(var b,c,d,e,f,g,h,i="",j=0,k=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");j<k.length;)e=this._keyStr.indexOf(k.charAt(j++)),f=this._keyStr.indexOf(k.charAt(j++)),g=this._keyStr.indexOf(k.charAt(j++)),h=this._keyStr.indexOf(k.charAt(j++)),b=e<<2|f>>4,c=(15&f)<<4|g>>2,d=(3&g)<<6|h,i+=String.fromCharCode(b),64!=g&&(i+=String.fromCharCode(c)),64!=h&&(i+=String.fromCharCode(d));return i=org.owasp.esapi.codecs.UTF8.decode(i)}},$namespace("org.owasp.esapi.codecs"),org.owasp.esapi.codecs.CSSCodec=function(){var a=new org.owasp.esapi.codecs.Codec;return{encode:a.encode,decode:a.decode,encodeCharacter:function(a,b){if(a.indexOf(b)>-1)return b;var c=org.owasp.esapi.codecs.Codec.getHexForNonAlphanumeric(b);return null==c?b:"\\"+c+" "},decodeCharacter:function(a){a.mark();var b=a.next();if(null==b)return a.reset(),null;if("\\"!=b)return a.reset(),null;var c=a.next();if(null==c)return a.reset(),null;if(a.isHexDigit(c)){for(var d=c,e=0;6>e;e++){var f=a.next();if(null==f||32==f.charCodeAt(0))break;if(!a.isHexDigit(f)){input.pushback(f);break}d+=f}try{var g=parseInt(d,16);return String.fromCharCode(g)}catch(h){return a.reset(),null}}return c}}},$namespace("org.owasp.esapi.codecs"),org.owasp.esapi.codecs.Codec=function(){return{encode:function(a,b){for(var c="",d=0;d<b.length;d++){var e=b.charAt(d);c+=this.encodeCharacter(a,e)}return c},encodeCharacter:function(a,b){return b},decode:function(a){for(var b="",c=new org.owasp.esapi.codecs.PushbackString(a);c.hasNext();){var d=this.decodeCharacter(c);b+=null!=d?d:c.next()}return b},decodeCharacter:function(a){return a.next()}}},org.owasp.esapi.codecs.Codec.getHexForNonAlphanumeric=function(a){return a.charCodeAt(0)<256?org.owasp.esapi.codecs.Codec.hex[a.charCodeAt(0)]:a.charCodeAt(0).toString(16)},org.owasp.esapi.codecs.Codec.hex=[];for(var c=0;255>c;c++)c>=48&&57>=c||c>=65&&90>=c||c>=97&&122>=c?org.owasp.esapi.codecs.Codec.hex[c]=null:org.owasp.esapi.codecs.Codec.hex[c]=c.toString(16);var entityToCharacterMap=[];entityToCharacterMap["&quot"]="34",entityToCharacterMap["&amp"]="38",entityToCharacterMap["&lt"]="60",entityToCharacterMap["&gt"]="62",entityToCharacterMap["&nbsp"]="160",entityToCharacterMap["&iexcl"]="161",entityToCharacterMap["&cent"]="162",entityToCharacterMap["&pound"]="163",entityToCharacterMap["&curren"]="164",entityToCharacterMap["&yen"]="165",entityToCharacterMap["&brvbar"]="166",entityToCharacterMap["&sect"]="167",entityToCharacterMap["&uml"]="168",entityToCharacterMap["&copy"]="169",entityToCharacterMap["&ordf"]="170",entityToCharacterMap["&laquo"]="171",entityToCharacterMap["&not"]="172",entityToCharacterMap["&shy"]="173",entityToCharacterMap["&reg"]="174",entityToCharacterMap["&macr"]="175",entityToCharacterMap["&deg"]="176",entityToCharacterMap["&plusmn"]="177",entityToCharacterMap["&sup2"]="178",entityToCharacterMap["&sup3"]="179",entityToCharacterMap["&acute"]="180",entityToCharacterMap["&micro"]="181",entityToCharacterMap["&para"]="182",entityToCharacterMap["&middot"]="183",entityToCharacterMap["&cedil"]="184",entityToCharacterMap["&sup1"]="185",entityToCharacterMap["&ordm"]="186",entityToCharacterMap["&raquo"]="187",entityToCharacterMap["&frac14"]="188",entityToCharacterMap["&frac12"]="189",entityToCharacterMap["&frac34"]="190",entityToCharacterMap["&iquest"]="191",entityToCharacterMap["&Agrave"]="192",entityToCharacterMap["&Aacute"]="193",entityToCharacterMap["&Acirc"]="194",entityToCharacterMap["&Atilde"]="195",entityToCharacterMap["&Auml"]="196",entityToCharacterMap["&Aring"]="197",entityToCharacterMap["&AElig"]="198",entityToCharacterMap["&Ccedil"]="199",entityToCharacterMap["&Egrave"]="200",entityToCharacterMap["&Eacute"]="201",entityToCharacterMap["&Ecirc"]="202",entityToCharacterMap["&Euml"]="203",entityToCharacterMap["&Igrave"]="204",entityToCharacterMap["&Iacute"]="205",entityToCharacterMap["&Icirc"]="206",entityToCharacterMap["&Iuml"]="207",entityToCharacterMap["&ETH"]="208",entityToCharacterMap["&Ntilde"]="209",entityToCharacterMap["&Ograve"]="210",entityToCharacterMap["&Oacute"]="211",entityToCharacterMap["&Ocirc"]="212",entityToCharacterMap["&Otilde"]="213",entityToCharacterMap["&Ouml"]="214",entityToCharacterMap["&times"]="215",entityToCharacterMap["&Oslash"]="216",entityToCharacterMap["&Ugrave"]="217",entityToCharacterMap["&Uacute"]="218",entityToCharacterMap["&Ucirc"]="219",entityToCharacterMap["&Uuml"]="220",entityToCharacterMap["&Yacute"]="221",entityToCharacterMap["&THORN"]="222",entityToCharacterMap["&szlig"]="223",entityToCharacterMap["&agrave"]="224",entityToCharacterMap["&aacute"]="225",entityToCharacterMap["&acirc"]="226",entityToCharacterMap["&atilde"]="227",entityToCharacterMap["&auml"]="228",entityToCharacterMap["&aring"]="229",entityToCharacterMap["&aelig"]="230",entityToCharacterMap["&ccedil"]="231",entityToCharacterMap["&egrave"]="232",entityToCharacterMap["&eacute"]="233",entityToCharacterMap["&ecirc"]="234",entityToCharacterMap["&euml"]="235",entityToCharacterMap["&igrave"]="236",entityToCharacterMap["&iacute"]="237",entityToCharacterMap["&icirc"]="238",entityToCharacterMap["&iuml"]="239",entityToCharacterMap["&eth"]="240",entityToCharacterMap["&ntilde"]="241",entityToCharacterMap["&ograve"]="242",entityToCharacterMap["&oacute"]="243",entityToCharacterMap["&ocirc"]="244",entityToCharacterMap["&otilde"]="245",entityToCharacterMap["&ouml"]="246",entityToCharacterMap["&divide"]="247",entityToCharacterMap["&oslash"]="248",entityToCharacterMap["&ugrave"]="249",entityToCharacterMap["&uacute"]="250",entityToCharacterMap["&ucirc"]="251",entityToCharacterMap["&uuml"]="252",entityToCharacterMap["&yacute"]="253",entityToCharacterMap["&thorn"]="254",entityToCharacterMap["&yuml"]="255",entityToCharacterMap["&OElig"]="338",entityToCharacterMap["&oelig"]="339",entityToCharacterMap["&Scaron"]="352",entityToCharacterMap["&scaron"]="353",entityToCharacterMap["&Yuml"]="376",entityToCharacterMap["&fnof"]="402",entityToCharacterMap["&circ"]="710",entityToCharacterMap["&tilde"]="732",entityToCharacterMap["&Alpha"]="913",entityToCharacterMap["&Beta"]="914",entityToCharacterMap["&Gamma"]="915",entityToCharacterMap["&Delta"]="916",entityToCharacterMap["&Epsilon"]="917",entityToCharacterMap["&Zeta"]="918",entityToCharacterMap["&Eta"]="919",entityToCharacterMap["&Theta"]="920",entityToCharacterMap["&Iota"]="921",entityToCharacterMap["&Kappa"]="922",entityToCharacterMap["&Lambda"]="923",entityToCharacterMap["&Mu"]="924",entityToCharacterMap["&Nu"]="925",entityToCharacterMap["&Xi"]="926",entityToCharacterMap["&Omicron"]="927",entityToCharacterMap["&Pi"]="928",entityToCharacterMap["&Rho"]="929",entityToCharacterMap["&Sigma"]="931",entityToCharacterMap["&Tau"]="932",entityToCharacterMap["&Upsilon"]="933",entityToCharacterMap["&Phi"]="934",entityToCharacterMap["&Chi"]="935",entityToCharacterMap["&Psi"]="936",entityToCharacterMap["&Omega"]="937",entityToCharacterMap["&alpha"]="945",entityToCharacterMap["&beta"]="946",entityToCharacterMap["&gamma"]="947",entityToCharacterMap["&delta"]="948",entityToCharacterMap["&epsilon"]="949",entityToCharacterMap["&zeta"]="950",entityToCharacterMap["&eta"]="951",entityToCharacterMap["&theta"]="952",entityToCharacterMap["&iota"]="953",entityToCharacterMap["&kappa"]="954",entityToCharacterMap["&lambda"]="955",entityToCharacterMap["&mu"]="956",entityToCharacterMap["&nu"]="957",entityToCharacterMap["&xi"]="958",entityToCharacterMap["&omicron"]="959",entityToCharacterMap["&pi"]="960",entityToCharacterMap["&rho"]="961",entityToCharacterMap["&sigmaf"]="962",entityToCharacterMap["&sigma"]="963",entityToCharacterMap["&tau"]="964",entityToCharacterMap["&upsilon"]="965",entityToCharacterMap["&phi"]="966",entityToCharacterMap["&chi"]="967",entityToCharacterMap["&psi"]="968",entityToCharacterMap["&omega"]="969",entityToCharacterMap["&thetasym"]="977",entityToCharacterMap["&upsih"]="978",entityToCharacterMap["&piv"]="982",entityToCharacterMap["&ensp"]="8194",entityToCharacterMap["&emsp"]="8195",entityToCharacterMap["&thinsp"]="8201",entityToCharacterMap["&zwnj"]="8204",entityToCharacterMap["&zwj"]="8205",entityToCharacterMap["&lrm"]="8206",entityToCharacterMap["&rlm"]="8207",entityToCharacterMap["&ndash"]="8211",entityToCharacterMap["&mdash"]="8212",entityToCharacterMap["&lsquo"]="8216",entityToCharacterMap["&rsquo"]="8217",entityToCharacterMap["&sbquo"]="8218",entityToCharacterMap["&ldquo"]="8220",entityToCharacterMap["&rdquo"]="8221",entityToCharacterMap["&bdquo"]="8222",entityToCharacterMap["&dagger"]="8224",entityToCharacterMap["&Dagger"]="8225",entityToCharacterMap["&bull"]="8226",entityToCharacterMap["&hellip"]="8230",entityToCharacterMap["&permil"]="8240",entityToCharacterMap["&prime"]="8242",entityToCharacterMap["&Prime"]="8243",entityToCharacterMap["&lsaquo"]="8249",entityToCharacterMap["&rsaquo"]="8250",entityToCharacterMap["&oline"]="8254",entityToCharacterMap["&frasl"]="8260",entityToCharacterMap["&euro"]="8364",entityToCharacterMap["&image"]="8365",entityToCharacterMap["&weierp"]="8472",entityToCharacterMap["&real"]="8476",entityToCharacterMap["&trade"]="8482",entityToCharacterMap["&alefsym"]="8501",entityToCharacterMap["&larr"]="8592",entityToCharacterMap["&uarr"]="8593",entityToCharacterMap["&rarr"]="8594",entityToCharacterMap["&darr"]="8595",entityToCharacterMap["&harr"]="8596",entityToCharacterMap["&crarr"]="8629",entityToCharacterMap["&lArr"]="8656",entityToCharacterMap["&uArr"]="8657",entityToCharacterMap["&rArr"]="8658",entityToCharacterMap["&dArr"]="8659",entityToCharacterMap["&hArr"]="8660",entityToCharacterMap["&forall"]="8704",entityToCharacterMap["&part"]="8706",entityToCharacterMap["&exist"]="8707",entityToCharacterMap["&empty"]="8709",entityToCharacterMap["&nabla"]="8711",entityToCharacterMap["&isin"]="8712",entityToCharacterMap["&notin"]="8713",entityToCharacterMap["&ni"]="8715",entityToCharacterMap["&prod"]="8719",entityToCharacterMap["&sum"]="8721",entityToCharacterMap["&minus"]="8722",entityToCharacterMap["&lowast"]="8727",entityToCharacterMap["&radic"]="8730",entityToCharacterMap["&prop"]="8733",entityToCharacterMap["&infin"]="8734",entityToCharacterMap["&ang"]="8736",entityToCharacterMap["&and"]="8743",entityToCharacterMap["&or"]="8744",entityToCharacterMap["&cap"]="8745",entityToCharacterMap["&cup"]="8746",entityToCharacterMap["&int"]="8747",entityToCharacterMap["&there4"]="8756",entityToCharacterMap["&sim"]="8764",entityToCharacterMap["&cong"]="8773",entityToCharacterMap["&asymp"]="8776",entityToCharacterMap["&ne"]="8800",entityToCharacterMap["&equiv"]="8801",entityToCharacterMap["&le"]="8804",entityToCharacterMap["&ge"]="8805",entityToCharacterMap["&sub"]="8834",entityToCharacterMap["&sup"]="8835",entityToCharacterMap["&nsub"]="8836",entityToCharacterMap["&sube"]="8838",entityToCharacterMap["&supe"]="8839",entityToCharacterMap["&oplus"]="8853",entityToCharacterMap["&otimes"]="8855",entityToCharacterMap["&perp"]="8869",entityToCharacterMap["&sdot"]="8901",entityToCharacterMap["&lceil"]="8968",entityToCharacterMap["&rceil"]="8969",entityToCharacterMap["&lfloor"]="8970",entityToCharacterMap["&rfloor"]="8971",entityToCharacterMap["&lang"]="9001",entityToCharacterMap["&rang"]="9002",entityToCharacterMap["&loz"]="9674",entityToCharacterMap["&spades"]="9824",entityToCharacterMap["&clubs"]="9827",entityToCharacterMap["&hearts"]="9829",entityToCharacterMap["&diams"]="9830";var characterToEntityMap=[];for(var entity in entityToCharacterMap)characterToEntityMap[entityToCharacterMap[entity]]=entity;$namespace("org.owasp.esapi.codecs"),org.owasp.esapi.codecs.HTMLEntityCodec=function(){var a=new org.owasp.esapi.codecs.Codec,b=function(a){var b=a.peek();return null==b?null:"x"==b||"X"==b?(a.next(),d(a)):c(a)},c=function(a){for(var b="";a.hasNext();){var c=a.peek();if(!c.match(/[0-9]/)){if(";"==c){a.next();break}break}b+=c,a.next()}try{return parseInt(b)}catch(d){return null}},d=function(a){for(var b="";a.hasNext();){var c=a.peek();if(!c.match(/[0-9A-Fa-f]/)){if(";"==c){a.next();break}break}b+=c,a.next()}try{return parseInt(b,16)}catch(d){return null}},e=function(a){for(var b="";a.hasNext();){var c=a.peek();if(c.match(/[A-Za-z]/)){if(b+=c,a.next(),entityToCharacterMap.containsKey("&"+b)){a.peek(";")&&a.next();break}}else{if(";"!=c)break;a.next()}}return String.fromCharCode(entityToCharacterMap.getCaseInsensitive("&"+b))};return{encode:a.encode,decode:a.decode,encodeCharacter:function(a,b){if(a.indexOf(b)>-1)return b;var c=org.owasp.esapi.codecs.Codec.getHexForNonAlphanumeric(b);if(null==c)return b;var d=b.charCodeAt(0);if(31>=d&&"	"!=b&&"\n"!=b&&"\r"!=b||d>=127&&159>=d||" "==b)return" ";var e=characterToEntityMap[d];return null!=e?e+";":"&#x"+c+";"},decodeCharacter:function(a){var c=a;c.mark();var d=c.next();if(null==d||"&"!=d)return c.reset(),null;var f=c.next();if(null==f)return c.reset(),null;if("#"==f){var g=b(c);if(null!=g)return g}else if(f.match(/[A-Za-z]/)&&(c.pushback(f),g=e(c),null!=g))return g;return c.reset(),null}}},$namespace("org.owasp.esapi.codecs"),org.owasp.esapi.codecs.JavascriptCodec=function(){var a=new org.owasp.esapi.codecs.Codec;return{encode:function(a,b){for(var c="",d=0;d<b.length;d++){var e=b.charAt(d);if(a.indexOf(e)>-1)c+=e;else{var f=org.owasp.esapi.codecs.Codec.getHexForNonAlphanumeric(e);if(null==f)c+=e;else{var g=e.charCodeAt(0).toString(16);if(e.charCodeAt(0)<256){var h="00".substr(g.length);c+="\\x"+h+g.toUpperCase()}else h="0000".substr(g.length),c+="\\u"+h+g.toUpperCase()}}}return c},decode:a.decode,decodeCharacter:function(a){a.mark();var b=a.next();if(null==b)return a.reset(),null;if("\\"!=b)return a.reset(),null;var c=a.next();if(null==c)return a.reset(),null;if("b"==c)return 8;if("t"==c)return 9;if("n"==c)return 10;if("v"==c)return 11;if("f"==c)return 12;if("r"==c)return 13;if('"'==c)return 34;if("'"==c)return 39;if("\\"==c)return 92;if("x"==c.toLowerCase()){h="";for(var d=0;2>d;d++){var e=a.nextHex();if(null==e)return input.reset(),null;h+=e}try{return g=parseInt(h,16),String.fromCharCode(g)}catch(f){return a.reset(),null}}else if("u"==c.toLowerCase()){for(h="",d=0;4>d;d++){if(e=a.nextHex(),null==e)return input.reset(),null;h+=e}try{var g=parseInt(h,16);return String.fromCharCode(g)}catch(f){return a.reset(),null}}else if(a.isOctalDigit(c)){var h=c,i=a.next();if(a.isOctalDigit(i)){h+=i;var j=a.next();a.isOctalDigit(j)?h+=j:a.pushback(j)}else a.pushback(i);try{return g=parseInt(h,8),String.fromCharCode(g)}catch(f){return a.reset(),null}}return c}}},$namespace("org.owasp.esapi.codecs"),org.owasp.esapi.codecs.PercentCodec=function(){var a=new org.owasp.esapi.codecs.Codec,b="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",c="-._~",d=!0,e=b+(d?"":c),f=function(a){var b="";if(-128>a||a>127)throw new IllegalArgumentException("b is not a byte (was "+a+")");return a&=255,16>a&&(b+="0"),b+a.toString(16).toUpperCase()};return{encode:a.encode,decode:a.decode,encodeCharacter:function(a,b){if(e.indexOf(b)>-1)return b;for(var c=org.owasp.esapi.codecs.UTF8.encode(b),d="",g=0;g<c.length;g++)d+="%"+f(c.charCodeAt(g));return d},decodeCharacter:function(a){a.mark();var b=a.next();if(null==b||"%"!=b)return a.reset(),null;for(var c="",d=0;2>d;d++){var e=a.nextHex();null!=e&&(c+=e)}if(2==c.length)try{var f=parseInt(c,16);return String.fromCharCode(f)}catch(g){}return a.reset(),null}}},$namespace("org.owasp.esapi.codecs"),org.owasp.esapi.codecs.PushbackString=function(a){var b=a,c="",d="",e=0,f=0;return{pushback:function(a){c=a},index:function(){return e},hasNext:function(){return null!=c?!0:!(null==b||0==b.length||e>=b.length)},next:function(){if(null!=c){var a=c;return c=null,a}return null==b||0==b.length||e>=b.length?null:b.charAt(e++)},nextHex:function(){var a=this.next();return this.isHexDigit(a)?a:null},nextOctal:function(){var a=this.next();return this.isOctalDigit(a)?a:null},isHexDigit:function(a){return null!=a&&(a>="0"&&"9">=a||a>="a"&&"f">=a||a>="A"&&"F">=a)},isOctalDigit:function(a){return null!=a&&a>="0"&&"7">=a},peek:function(a){return a?null!=c&&c==a?!0:null==b||0==b.length||e>=b.length?!1:b.charAt(e)==a:null!=c?c:null==b||0==b.length||e>=b.length?null:b.charAt(e)},mark:function(){d=c,f=e},reset:function(){c=d,e=f},remainder:function(){var a=b.substr(e);return null!=c&&(a=c+a),a}}},$namespace("org.owasp.esapi.codecs"),org.owasp.esapi.codecs.UTF8={encode:function(a){for(var b=a.replace(/\r\n/g,"\n"),c="",d=0;d<b.length;d++){var e=b.charCodeAt(d);128>e?c+=String.fromCharCode(e):e>127&&2048>e?(c+=String.fromCharCode(e>>6|192),c+=String.fromCharCode(63&e|128)):(c+=String.fromCharCode(e>>12|224),c+=String.fromCharCode(e>>6&63|128),c+=String.fromCharCode(63&e|128))}return c},decode:function(a){for(var b="",d=c=c1=c2=0;d<a.length;)c=a.charCodeAt(d),128>c?(b+=String.fromCharCode(c),d++):c>191&&224>c?(c2=a.charCodeAt(d+1),b+=String.fromCharCode((31&c)<<6|63&c2),d+=2):(c2=utftext.charCodeAt(d+1),c3=utftext.charCodeAt(d+2),string+=String.fromCharCode((15&c)<<12|(63&c2)<<6|63&c3),d+=3);return b}},$namespace("org.owasp.esapi.i18n"),org.owasp.esapi.i18n.ArrayResourceBundle=function(sName,oLocale,aMessages,oParent){with(org.owasp.esapi.i18n)var _super=new ResourceBundle(sName,oLocale,oParent);var messages=aMessages;return{getParent:_super.getParent,getLocale:_super.getLocale,getName:_super.getName,getString:_super.getString,getMessage:function(a){return messages[a]}}},$namespace("org.owasp.esapi.i18n"),org.owasp.esapi.i18n.Locale=function(a,b,c){var d=a,e=b,f=c;return{getLanguage:function(){return d},getCountry:function(){return e},getVariant:function(){return f},toString:function(){return d+(e?"-"+e+(f?"-"+f:""):"")}}},org.owasp.esapi.i18n.Locale.US=new org.owasp.esapi.i18n.Locale("en","US"),org.owasp.esapi.i18n.Locale.GB=new org.owasp.esapi.i18n.Locale("en","GB"),org.owasp.esapi.i18n.Locale.getLocale=function(a){var b=a.split("-");return new org.owasp.esapi.i18n.Locale(b[0],b.length>1?b[1]:"",b.length>2?b.length[2]:"")},org.owasp.esapi.i18n.Locale.getDefault=function(){var a=(navigator.language?navigator.language:navigator.userLanguage?navigator.userLanguage:"en-US").split("-");return new org.owasp.esapi.i18n.Locale(a[0],a.length>1?a[1]:"",a.length>2?a.length[2]:"")},$namespace("org.owasp.esapi.i18n"),org.owasp.esapi.i18n.ObjectResourceBundle=function(a,b){var c=new org.owasp.esapi.i18n.ResourceBundle(a.name,org.owasp.esapi.i18n.Locale.getLocale(a.locale),b),d=a.messages;return{getParent:c.getParent,getLocale:c.getLocale,getName:c.getName,getString:c.getString,getMessage:function(a){return d[a]}}},$namespace("org.owasp.esapi.i18n"),org.owasp.esapi.i18n.ResourceBundle=function(a,b,c){var d=c,e=b,f=a;if(!f)throw new SyntaxError("Name required for implementations of org.owasp.esapi.i18n.ResourceBundle");if(!e)throw new SyntaxError("Locale required for implementations of org.owasp.esapi.i18n.ResourceBundle");return{getParent:function(){return d},getLocale:function(){return e},getName:function(){return f},getMessage:function(a){return a},getString:function(a,b){if(arguments.length<1)throw new IllegalArgumentException("No key passed to getString");var c=this.getMessage(a);if(!c)return d?d.getString(a,b):a;if(!c.match(/\{([A-Za-z]+)\}/)||!b)return c;for(var e="",f=0;;){var g=c.indexOf("{",f),h=c.indexOf("}",g);
if(0>g){e+=c.substr(f,c.length-f);break}if(g>=0&&-1>h)throw new SyntaxError("Invalid Message - Unclosed Context Reference: "+c);e+=c.substring(f,g);var i=c.substring(g+1,h);e+=b[i]?b[i]:c.substring(g,h+1),f=h+1}return e}}},org.owasp.esapi.i18n.ResourceBundle.getResourceBundle=function(sResource,oLocale){var classname=sResource+"_"+oLocale.toString().replace("-","_");with(org.owasp.esapi.i18n)return ResourceBundle[classname]instanceof Object?ResourceBundle[classname]:new ResourceBundle[classname]},$namespace("org.owasp.esapi.net"),org.owasp.esapi.net.Cookie=function(a,b){var c,d,e,f,g,h,i,j,k=$ESAPI.resourceBundle(),l=",; ",m=function(a){for(var b=0,c=a.length;c>b;b++){var d=a.charCodeAt(b),e=a.charAt(b);if(32>d||d>=127||-1!=l.indexOf(e))return!1}return!0};if(!m(a)||"comment"==a.toLowerCase()||"discard"==a.toLowerCase()||"domain"==a.toLowerCase()||"expires"==a.toLowerCase()||"max-age"==a.toLowerCase()||"path"==a.toLowerCase()||"secure"==a.toLowerCase()||"version"==a.toLowerCase()||"$"==a.charAt(0)){var n=k.getString("Cookie.Name",{name:a});throw new IllegalArgumentException(n)}return c=a,d=b,{setComment:function(a){e=a},getComment:function(){return e},setDomain:function(a){f=a.toLowerCase()},getDomain:function(){return f},setMaxAge:function(a){g=a},getMaxAge:function(){return g},setPath:function(a){h=a},getPath:function(){return h},setSecure:function(a){i=a},getSecure:function(){return i},getName:function(){return c},setValue:function(a){d=a},getValue:function(){return d},setVersion:function(a){if(0>a||a>1)throw new IllegalArgumentException(k.getString("Cookie.Version",{version:a}));j=a},getVersion:function(){return j}}},$namespace("org.owasp.esapi.reference.encoding"),org.owasp.esapi.reference.encoding.DefaultEncoder=function(a){var b=[],c=new org.owasp.esapi.codecs.HTMLEntityCodec,d=new org.owasp.esapi.codecs.JavascriptCodec,e=new org.owasp.esapi.codecs.CSSCodec,f=new org.owasp.esapi.codecs.PercentCodec;a?b=a:(b.push(c),b.push(d),b.push(e),b.push(f));var g=new Array(",",".","-","_"," "),h=new Array(",",".","-","_"),i=new Array,j=new Array(",",".","_");return{cananicalize:function(a,c){if(!a)return null;for(var d=a,e=null,f=1,g=0,h=!1;!h;)h=!0,b.each(function(a){var b=d;d=a.decode(d),b!=d&&(null!=e&&e!=a&&f++,e=a,h&&g++,h=!1)});if(g>=2&&f>1){if(c)throw new org.owasp.esapi.IntrusionException("Input validation failure","Multiple ("+g+"x) and mixed encoding ("+f+"x) detected in "+a)}else if(g>=2){if(c)throw new org.owasp.esapi.IntrusionException("Input validation failure","Multiple ("+g+"x) encoding detected in "+a)}else if(f>1&&c)throw new org.owasp.esapi.IntrusionException("Input validation failure","Mixed ("+f+"x) encoding detected in "+a);return d},normalize:function(a){return a.replace(/[^\x00-\x7F]/g,"")},encodeForHTML:function(a){return a?c.encode(g,a):null},decodeForHTML:function(a){return a?c.decode(a):null},encodeForHTMLAttribute:function(a){return a?c.encode(h,a):null},encodeForCSS:function(a){return a?e.encode(i,a):null},encodeForJavaScript:function(a){return a?d.encode(j,a):null},encodeForJavascript:this.encodeForJavaScript,encodeForURL:function(a){return a?escape(a):null},decodeFromURL:function(a){return a?unescape(a):null},encodeForBase64:function(a){return a?org.owasp.esapi.codecs.Base64.encode(a):null},decodeFromBase64:function(a){return a?org.owasp.esapi.codecs.Base64.decode(a):null}}},$namespace("org.owasp.esapi.reference.logging"),org.owasp.esapi.reference.logging.Log4JSLogFactory=function(){var a=Array(),b=function(a){var b=null,c=a?a:null,d=Log4js.Level,e=!1,f=!1,g=!1,h=$ESAPI.encoder().encodeForHTML;b=Log4js.getLogger(c);var i=function(a){var b=org.owasp.esapi.Logger;switch(a){case b.OFF:return Log4js.Level.OFF;case b.FATAL:return Log4js.Level.FATAL;case b.ERROR:return Log4js.Level.ERROR;case b.WARNING:return Log4js.Level.WARN;case b.INFO:return Log4js.Level.INFO;case b.DEBUG:return Log4js.Level.DEBUG;case b.TRACE:return Log4js.Level.TRACE;case b.ALL:return Log4js.Level.ALL}};return{setLevel:function(a){try{b.setLevel(i(a))}catch(c){this.error(org.owasp.esapi.Logger.SECURITY_FAILURE,"",c)}},trace:function(a,b,c){this.log(d.TRACE,a,b,c)},debug:function(a,b,c){this.log(d.DEBUG,a,b,c)},info:function(a,b,c){this.log(d.INFO,a,b,c)},warning:function(a,b,c){this.log(d.WARN,a,b,c)},error:function(a,b,c){this.log(d.ERROR,a,b,c)},fatal:function(a,b,c){this.log(d.FATAL,a,b,c)},log:function(a,c,i,j){switch(a){case d.TRACE:if(!b.isTraceEnabled())return;break;case d.DEBUG:if(!b.isDebugEnabled())return;break;case d.INFO:if(!b.isInfoEnabled())return;break;case d.WARNING:if(!b.isWarnEnabled())return;break;case d.ERROR:if(!b.isErrorEnabled())return;break;case d.FATAL:if(!b.isFatalEnabled())return}i||(i=""),i="["+c.toString()+"] - "+i;var k=i.replace("\n","_").replace("\r","_");g&&(k=h(k),k!=i&&(k+=" [Encoded]"));var l=(e?window.location.href:"")+(f?"/"+$ESAPI.properties.application.Name:"");b.log(a,(""!=l?"["+l+"] ":"")+k,j)},addAppender:function(a){b.addAppender(a)},isLogUrl:function(){return e},setLogUrl:function(a){e=a},isLogApplicationName:function(){return f},setLogApplicationName:function(a){f=a},isEncodingRequired:function(){return g},setEncodingRequired:function(a){g=a},setEncodingFunction:function(a){h=a},isDebugEnabled:function(){return b.isDebugEnabled()},isErrorEnabled:function(){return b.isErrorEnabled()},isFatalEnabled:function(){return b.isFatalEnabled()},isInfoEnabled:function(){return b.isInfoEnabled()},isTraceEnabled:function(){return b.isTraceEnabled()},isWarningEnabled:function(){return b.isWarnEnabled()}}},c=function(a){var b=$ESAPI.properties.logging;return b[a]&&(b=b[a]),b};return{getLogger:function(d){var e="string"==typeof d?d:d.constructor.toString(),f=a[e];if(!f){f=new b(e);var g=c(d);f.setLevel(g.Level),f.setLogUrl(g.LogUrl),f.setLogApplicationName(g.LogApplicationName),f.setEncodingRequired(g.EncodingRequired),g.EncodingFunction&&f.setEncodingFunction(g.EncodingFunction),g.Appenders.each(function(a){g.Layout&&a.setLayout(g.Layout),f.addAppender(a)}),a[e]=f}return f}}},$namespace("org.owasp.esapi.reference.validation"),org.owasp.esapi.reference.validation.BaseValidationRule=function(a,b,c){var d,e=$ESAPI.logger("Validation"),f=org.owasp.esapi.Logger.EventType,g=a,h=b?b:$ESAPI.encoder(),i=!1,j=org.owasp.esapi.i18n.ResourceBundle,k=c?c:$ESAPI.locale();return $ESAPI.properties.validation.ResourceBundle&&(d=j.getResourceBundle($ESAPI.properties.validation.ResourceBundle,k)),d||(d=$ESAPI.resourceBundle(),e.info(f.EVENT_FAILURE,"No Validation ResourceBundle - Defaulting to "+d.getName()+"("+d.getLocale().toString()+")")),e.info(f.EVENT_SUCCESS,"Validation Rule Initialized with ResourceBundle: "+d.getName()),{setAllowNull:function(a){i=a},isAllowNull:function(){return i},getTypeName:function(){return g},setTypeName:function(a){g=a},setEncoder:function(a){h=a},getEncoder:function(){return h},assertValid:function(a,b){this.getValid(a,b)},getValid:function(a,b,c){var d=null;try{d=this.getValidInput(a,b)}catch(e){return this.sanitize(a,b)}return d},getValidInput:function(a,b){return b},getSafe:function(a,b){var c=null;try{c=this.getValidInput(a,b)}catch(d){return this.sanitize(a,b)}return c},sanitize:function(a,b){return b},isValid:function(a,b){var c=!1;try{this.getValidInput(a,b),c=!0}catch(d){return!1}return c},whitelist:function(a,b){for(var c="",d=0;d<a.length;d++){var e=a.charAt(d);b.indexOf(e)>-1&&(c+=e)}return c},getUserMessage:function(a,b,c){return this.getMessage(a+".Usr",b+".Usr",c)},getLogMessage:function(a,b,c){return this.getMessage(a+".Log",b+".Log",c)},getMessage:function(a,b,c){return d.getString(a,c)?d.getString(a,c):d.getString(b,c)},validationException:function(a,b,c,d){throw new org.owasp.esapi.reference.validation.ValidationException(this.getUserMessage(a+"."+c,b+"."+c,d),this.getLogMessage(a+"."+c,b+"."+c,d),a)}}},$namespace("org.owasp.esapi.reference.validation"),org.owasp.esapi.reference.validation.CreditCardValidationRule=function(a,b,c){var d,e=new org.owasp.esapi.reference.validation.BaseValidationRule(a,b,c),f="CreditCard",g=19,h=function(){var a=new RegExp($ESAPI.properties.validation.CreditCard),b=new org.owasp.esapi.reference.validation.StringValidationRule("ccrule",e.getEncoder(),c,a);return b.setMaxLength(g),b.setAllowNull(!1),b};ccRule=h();var i=function(a){for(var b,c="",d=0;o<a.length;d++)b=a.charAt(d),b.match(/[0-9]/)&&(c+=b);for(var e=0,f=0,g=0,h=!1,i=c.length-1;i>=0;i--)f=parseInt(c.substring(i,d+1)),h?(g=2*f,g>9&&(g-=9)):g=f,e+=g,h=!h;return e%10==0};return{getMaxCardLength:function(){return g},setMaxCardLength:function(a){g=a},setAllowNull:e.setAllowNull,isAllowNull:e.isAllowNull,getTypeName:e.getTypeName,setTypeName:e.setTypeName,setEncoder:e.setEncoder,getEncoder:e.getEncoder,assertValid:e.assertValid,getValid:e.getValid,getValidInput:function(a,b){if(!b||""==b.trim()){if(this.isAllowNull())return null;e.validationException(a,f,"Required",{context:a,input:b})}var c=d.getValid(a,b);return i(c)||e.validationException(a,f,"Invalid",{context:a,input:b}),c},getSafe:e.getSafe,sanitize:function(a,b){return this.whitelist(b,org.owasp.esapi.EncoderConstants.CHAR_DIGITS)},isValid:e.isValid,whitelist:e.whitelist}},$namespace("org.owasp.esapi.reference.validation"),org.owasp.esapi.reference.validation.DateValidationRule=function(a,b,c){var d=new org.owasp.esapi.reference.validation.BaseValidationRule(a,b,c),e="Date",f=DateFormat.getDateInstance(),g=function(a,b){if(!a||""==a.trim()){if(d.isAllowNull())return null;d.validationException(a,e,"Required",{context:a,input:b,format:f})}var c=d.getEncoder().cananicalize(b);try{return f.parse(c)}catch(g){d.validationException(a,e,"Invalid",{context:a,input:b,format:f})}};return{setDateFormat:function(a){if(!a)throw new IllegalArgumentException("DateValidationRule.setDateFormat requires a non-null DateFormat");f=a},setAllowNull:d.setAllowNull,isAllowNull:d.isAllowNull,getTypeName:d.getTypeName,setTypeName:d.setTypeName,setEncoder:d.setEncoder,getEncoder:d.getEncoder,assertValid:d.assertValid,getValid:d.getValid,getValidInput:function(a,b){return g(a,b)},getSafe:d.getSafe,sanitize:function(a,b){var c=new Date(0);try{c=g(a,b)}catch(d){}return c},isValid:d.isValid,whitelist:d.whitelist}},$namespace("org.owasp.esapi.reference.validation"),org.owasp.esapi.reference.validation.DefaultValidator=function(a,b){var c=Array(),d=a?a:$ESAPI.encoder(),e=b?b:org.owasp.esapi.i18n.Locale.getDefault(),f=org.owasp.esapi.reference.validation;return{addRule:function(a){c[a.getName()]=a},getRule:function(a){return c[a]},isValidInput:function(a,b,c,d,e){try{return this.getValidInput(a,b,c,d,e),!0}catch(f){return!1}},getValidInput:function(a,b,c,f,g,h){var i=new org.owasp.esapi.reference.validation.StringValidationRule(c,d,e),j=new RegExp($ESAPI.properties.validation[c]);if(!(j&&j instanceof RegExp))throw new IllegalArgumentException("Invalid Type: "+c+" not found.");i.addWhitelistPattern(j),i.setMaxLength(f),i.setAllowNull(g);try{return i.getValid(a,b)}catch(k){throw k instanceof j.ValidationErrorList&&h&&h.addError(a,k),k}},isValidDate:function(a,b,c,d){try{return this.getValidDate(a,b,c,d),!0}catch(e){return!1}},getValidDate:function(a,b,c,g,h){var i=new f.DateValidationRule(a,d,e);i.setAllowNull(g),i.setDateFormat(c);try{return i.getValid(a,b)}catch(j){throw j instanceof f.ValidationErrorList&&h&&h.addError(a,j),j}},getValidCreditCard:function(a,b,c,g){var h=new f.CreditCardValidationRule(a,d,e);h.setAllowNull(c);try{return h.getValid(a,b)}catch(i){throw i instanceof f.ValidationErrorList&&g&&g.addError(a,i),i}},isValidCreditCard:function(a,b,c){try{return this.getValidCreditCard(a,b,c),!0}catch(d){return!1}},getValidNumber:function(a,b,c,g,h,i){var j=new f.NumberValidationRule(a,d,e,g,h);j.setAllowNull(c);try{return j.getValid(a,b)}catch(k){throw k instanceof f.ValidationErrorList&&i&&i.addError(a,k),k}},isValidNumber:function(a,b,c,d,e){try{return this.getValidNumber(a,b,c,d,e),!0}catch(f){return!1}},getValidInteger:function(a,b,c,g,h,i){var j=new f.IntegerValidationRule(a,d,e,g,h);j.setAllowNull(c);try{return j.getValid(a,b)}catch(k){throw k instanceof f.ValidationErrorList&&i&&i.addError(a,k),k}},isValidInteger:function(a,b,c,d,e){try{return this.getValidInteger(a,b,c,d,e),!0}catch(f){return!1}}}},$namespace("org.owasp.esapi.reference.validation"),org.owasp.esapi.reference.validation.IntegerValidationRule=function(a,b,c,d,e){var f=new org.owasp.esapi.reference.validation.BaseValidationRule(a,b,c),g="Integer",h=d?d:Number.MIN_VALUE,i=e?e:Number.MAX_VALUE;if(h>=i)throw new IllegalArgumentException("minValue must be less than maxValue");var j=function(a,b){if(!b||""==b.trim()){if(f.allowNull())return null;f.validationException(a,g,"Required",{context:a,input:b,minValue:h,maxValue:i})}var c=f.getEncoder().cananicalize(b),d=parseInt(c);return"NaN"==d&&f.validationException(a,g,"NaN",{context:a,input:b,minValue:h,maxValue:i}),h>d&&f.validationException(a,g,"MinValue",{context:a,input:b,minValue:h,maxValue:i}),d>i&&f.validationException(a,g,"MaxValue",{context:a,input:b,minValue:h,maxValue:i}),d};return{setMinValue:function(a){h=a},getMinValue:function(){return h},setMaxValue:function(a){i=a},getMaxValue:function(){return i},setAllowNull:f.setAllowNull,isAllowNull:f.isAllowNull,getTypeName:f.getTypeName,setTypeName:f.setTypeName,setEncoder:f.setEncoder,getEncoder:f.getEncoder,assertValid:f.assertValid,getValid:f.getValid,getValidInput:function(a,b){return j(a,b)},getSafe:f.getSafe,sanitize:function(a,b){var c=0;try{c=j(a,b)}catch(d){}return c},isValid:f.isValid,whitelist:f.whitelist}},$namespace("org.owasp.esapi.reference.validation"),org.owasp.esapi.reference.validation.NumberValidationRule=function(a,b,c,d,e){var f=new org.owasp.esapi.reference.validation.BaseValidationRule(a,b,c),g="Number",h=d?d:Number.MIN_VALUE,i=e?e:Number.MAX_VALUE;if(h>=i)throw new IllegalArgumentException("MinValue must be less that MaxValue");var j=function(a,b){if(!b||""==b.trim()){if(f.isAllowNull())return null;f.validationException(a,g,"Required",{context:a,input:b,minValue:h,maxValue:i})}var c=f.getEncoder().cananicalize(b),d=0;try{d=parseFloat(c)}catch(e){f.validationException(a,g,"Invalid",{context:a,input:b,minValue:h,maxValue:i})}return"NaN"==d&&f.validationException(a,g,"NaN",{context:a,input:b,minValue:h,maxValue:i}),h>d&&f.validationException(a,g,"MinValue",{context:a,input:b,minValue:h,maxValue:i}),d>i&&f.validationException(a,g,"MaxValue",{context:a,input:b,minValue:h,maxValue:i}),d};return{setMinValue:function(a){h=a},getMinValue:function(){return h},setMaxValue:function(a){i=a},getMaxValue:function(){return i},setAllowNull:f.setAllowNull,isAllowNull:f.isAllowNull,getTypeName:f.getTypeName,setTypeName:f.setTypeName,setEncoder:f.setEncoder,getEncoder:f.getEncoder,assertValid:f.assertValid,getValid:f.getValid,getValidInput:function(a,b){return j(a,b)},getSafe:f.getSafe,sanitize:function(a,b){var c=0;try{c=j(a,b)}catch(d){}return c},isValid:f.isValid,whitelist:f.whitelist}},$namespace("org.owasp.esapi.reference.validation"),org.owasp.esapi.reference.validation.StringValidationRule=function(a,b,c,d){var e=new org.owasp.esapi.reference.validation.BaseValidationRule(a,b,c),f="String",g=Array(),h=Array(),i=0,j=Number.MAX_VALUE,k=!0;if(d)if(d instanceof String)g.push(new RegExp(d));else{if(!(d instanceof RegExp))throw new IllegalArgumentException("sWhiteListPattern must be a string containing RegExp or a RegExp Object");g.push(d)}var l=function(a,b,c){g.each(function(d){b.match(d)&&e.validationException(a,f,"Whitelist",{context:a,input:b,orig:c,pattern:d.toString(),minLength:i,maxLength:j,validateInputAndCanonical:k})})},m=function(a,b,c){h.each(function(d){b.match(d)&&e.validationException(a,f,"Blacklist",{context:a,input:b,orig:c,pattern:d.toString(),minLength:i,maxLength:j,validateInputAndCanonical:k})})},n=function(a,b,c){return b.length<i&&e.validationException(a,f,"MinLength",{context:a,input:b,orig:c,minLength:i,maxLength:j,validateInputAndCanonical:k}),b.length>j&&e.validationException(a,f,"MaxLength",{context:a,input:b,orig:c,minLength:i,maxLength:j,validateInputAndCanonical:k}),b},o=function(a,b,c){if(!b||""==b.trim()){if(e.isAllowNull())return null;e.validationException(a,f,"Required",{context:a,input:b,orig:c,minLength:i,maxLength:j,validateInputAndCanonical:k})}};return{addWhitelistPattern:function(a){if(a instanceof String)g.push(new RegExp(a));else{if(!(a instanceof RegExp))throw new IllegalArgumentException("p must be a string containing RegExp or a RegExp Object");g.push(a)}},addBlacklistPattern:function(a){if(a instanceof String)h.push(new RegExp(a));else{if(!(a instanceof RegExp))throw new IllegalArgumentException("p must be a string containing RegExp or a RegExp Object");h.push(a)}},setMinLength:function(a){i=a},getMinLength:function(){return i},setMaxLength:function(a){j=a},getMaxLength:function(){return j},setValidateInputAndCanonical:function(a){k=a},isValidateInputAndCanonical:function(){return k},setAllowNull:e.setAllowNull,isAllowNull:e.isAllowNull,getTypeName:e.getTypeName,setTypeName:e.setTypeName,setEncoder:e.setEncoder,getEncoder:e.getEncoder,assertValid:e.assertValid,getValid:e.getValid,getValidInput:function(a,b){var c=null;return null==o(a,b)?null:(k&&(n(a,b),l(a,b),m(a,b)),c=this.getEncoder().cananicalize(b),null==o(a,c,b)?null:(n(a,c,b),l(a,c,b),m(a,c,b),c))},getSafe:e.getSafe,sanitize:function(a,b){return this.whitelist(b,org.owasp.esapi.EncoderConstants.CHAR_ALNUM)},isValid:e.isValid,whitelist:e.whitelist}},$namespace("org.owasp.esapi.reference.validation"),org.owasp.esapi.reference.validation.ValidationException=function(a,b){var c,d;arguments[2]&&arguments[2]instanceof Exception?(c=arguments[2],arguments[3]&&arguments[3]instanceof String&&(d=arguments[3])):arguments[2]&&arguments[2]instanceof String&&(d=arguments[2]);var e=new org.owasp.esapi.EnterpriseSecurityException(a,b,c);return{setContext:function(a){d=a},getContext:function(){return d},getMessage:e.getMessage,getUserMessage:e.getMessage,getLogMessage:e.getLogMessage,getStackTrace:e.getStackTrace,printStackTrace:e.printStackTrace}};